language: python

notifications:
  email: false

jobs:
  include:
    - os: osx
      osx_image: xcode12.2
      language: generic
      env: TOXENV=py37

before_install:
  - if [ $TRAVIS_OS_NAME = 'osx' ]; then
      brew install svn
      mkdir -p build/darwin
  
    elif [ $TRAVIS_OS_NAME = 'linux' ]; then
      echo linux not supported

    fi

  - cd Blender/blender
  - chmod u+x ./make
  - ./make update

install:
  - if [ $TRAVIS_OS_NAME = 'osx' ]; then
      cd ../../build/darwin

    elif [ $TRAVIS_OS_NAME = 'linux' ]; then
      cd ../../build/linux
    fi
  - cmake ../../Blender/blender -DWITH_PYTHON_INSTALL=OFF -DWITH_PYTHON_MODULE=ON -DWITH_MEM_JEMALLOC=OFF
  - ./make install -j$((`nproc`+1))

script:
  - chmod u+x .travis/script.sh
  - .travis/script.sh